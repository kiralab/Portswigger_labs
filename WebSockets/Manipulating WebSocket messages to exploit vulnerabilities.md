## Lab Description :

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/479abb2f-ee53-4760-bb58-7fbefad4c4a8)

## Overview :

 The majority of input-based vulnerabilities affecting WebSockets can be found and exploited by tampering with the contents of WebSocket messages.

For example, suppose a chat application uses WebSockets to send chat messages between the browser and the server. When a user types a chat message, a WebSocket message like the following is sent to the server:

```json
{"message":"Hello Carlos"}
```

The contents of the message are transmitted (again via WebSockets) to another chat user, and rendered in the user's browser as follows:
```html
<td>Hello Carlos</td>
```

In this situation, provided no other input processing or defenses are in play, an attacker can perform a proof-of-concept XSS attack by submitting the following WebSocket message:

```json
{"message":"<img src=1 onerror='alert(1)'>"}
```

## Solution :

The lab's home page has a link to **Live chat**.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/37f60787-07a5-4558-bac8-d224dbc4c6b9)

There we have an option to chat or send message to another user.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/b4d15a0c-2b10-4d28-ae02-fd4dff5ec21a)

We can view all the websocket requests & responses that have been sent and received under the **Web Sockets history** tab in Burp.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/68682d9d-371c-4b8e-90d4-7993da375ef3)

Since there is no sanitization of user input, we can send the following xss payload by intercepting the request & changing the value of *message* field in the JSON data.

```js
<img src=1 onerror='alert(1)'>
```
![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/ea3163af-b479-4a36-87fb-fcd35244d377)

Now both the client & the server users will get an XSS alert poopup.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/29a1c3ce-be66-4b43-9dac-f98080e4084a)

And now we have solved the lab.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/c8160178-4df6-4372-8a3a-18b15bee185a)






















