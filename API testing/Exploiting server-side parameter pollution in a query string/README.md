## Lab Description :

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/00cfd1a4-0399-4b08-9853-f7c3dba6f06a)

## Solution :

Visit the `My-Account` page, click on `forgot password`. 
Enter any username & capture the request.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/bc5d900d-da32-4df6-a184-4f71527fd9ba)

The server responds with **Invalid username**.

### Server side parameter pollution -

What if we give value of username as `administrator`?

This time we get this response which confirms that administrator account exists.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/df8adba6-c471-4860-9287-804b683ad12d)

Upon adding a `#` at the end of the username, the server responds differently.

> URL encode the special characters else the frontend will not send the entire url to backend.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/632c968a-31c5-4dda-a7dc-537adf7d7ddf)

So from this we can understad that there might be a parameter called `**Field**`

Upon adding `&a=b`, the server responds differently again - `"error": "Parameter is not supported."`

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/fb1f0881-28b6-43b4-9fae-b1b71dbb9b1e)

This is a good indication that the backend server does process the parameter.

Now we can try sending any invalid value to field parameter (`**&field=test#**`) to check what the server responds.

### Hidden parameter in JS file -

The `a` JS file contains the following code which reveals a hidden parameter called `reset_token`.

```c
   const resetToken = urlParams.get('reset-token');
    if (resetToken)
    {
        window.location.href = `/forgot-password?reset_token=${resetToken}`;
    }
```

Now in the field parameter we can enter this - `**&field=reset_token#**`.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/89438499-898b-42e4-b815-5c0753ba504c)

Now having the passord reset token for the administrator user, we can perform a GET request to `https://0a5200b30487309981671bc100890068.web-security-academy.net/forgot-password?reset_token=0envuvi6f1vnz0o6m7az4iykrixayq20` url to reset the admin's password.

We now get a page to set a new password for the admin user.

After resetting, we can login ad administrator.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/997e22fd-fbdc-4311-98fa-958ceac3d22c)

Goto **Admin panel** & delete the user carlos to solve the lab.

![image](https://github.com/sh3bu/Portswigger_labs/assets/67383098/64591fc8-87de-4bca-9478-2a1b3c413f3c)


